<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Mongoose v5.6.3-pre: </title><link rel="apple-touch-icon" sizes="57x57" href="images/favicon/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="images/favicon/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="images/favicon/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="images/favicon/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="images/favicon/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="images/favicon/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="images/favicon/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="images/favicon/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="images/favicon/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="images/favicon/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="images/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="images/favicon/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="images/favicon/favicon-16x16.png"><link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css" integrity="sha384-nn4HPE8lTHyVtfCBi5yW9d20FjT8BJwUXyWZT9InLYax14RDjBj46LmSztkmNP9w" crossorigin="anonymous"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans"><link rel="stylesheet" href="/docs/css/github.css"><link rel="stylesheet" href="/docs/css/mongoose5.css"><link rel="apple-touch-icon" sizes="57x57" href="images/favicon/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="images/favicon/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="images/favicon/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="images/favicon/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="images/favicon/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="images/favicon/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="images/favicon/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="images/favicon/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="images/favicon/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="images/favicon/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="images/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="images/favicon/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="images/favicon/favicon-16x16.png"><link rel="manifest" href="images/favicon/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="images/favicon/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="/docs/css/api.css"><link rel="stylesheet" href="/docs/css/inlinecpc.css"><script type="text/javascript" src="/docs/js/native.js"></script><style>.api-nav .nav-item-sub {
  display: block !important;
}

.api-content {
  margin-top: 3em;
}
</style></head><body><div id="layout"><div id="mobile-menu"><a class="menu-link" id="menuLink" href="#menu"><span></span></a><div id="mobile-logo-container"><a href="/"><img id="logo" src="/docs/images/mongoose5_62x30_transparent.png"><span class="logo-text">mongoose</span></a></div></div><div id="menu"><div class="pure-menu"><div class="pure-menu-heading" id="logo-container"><a href="/"><img id="logo" src="/docs/images/mongoose5_62x30_transparent.png"><span class="logo-text">mongoose</span></a></div><ul class="pure-menu-list" id="navbar"><li class="pure-menu-horizontal pure-menu-item pure-menu-has-children pure-menu-allow-hover version"><a class="pure-menu-link" href="#">Version 5.6.3-pre</a><ul class="pure-menu-children"><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/4.x">Version 4.13.18</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/3.8.x">Version 3.8.40</a></li></ul></li><li class="pure-menu-item search"><input id="search-input-nav" type="text" placeholder="Search"><button id="search-button-nav"><img src="/docs/images/search.svg"></button></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/index.html">Quick Start</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/guides.html">Guides</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/guide.html">Schemas</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/schematypes.html">SchemaTypes</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/connections.html">Connections</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/models.html">Models</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/documents.html">Documents</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/subdocs.html">Subdocuments</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/queries.html">Queries</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/validation.html">Validation</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/middleware.html">Middleware</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/populate.html">Populate</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/discriminators.html">Discriminators</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/plugins.html">Plugins</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/async-await.html">Async/Await</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/api.html">API</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/mongoose.html">Mongoose</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/schema.html">Schema</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/connection.html">Connection</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/document.html">Document</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/model.html">Model</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/query.html">Query</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/aggregate.html">Aggregate</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/schematype.html">SchemaType</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/virtualtype.html">VirtualType</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/compatibility.html">Version Compatibility</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/faq.html">FAQ</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/further_reading.html">Further Reading</a></li></ul><div class="cpc-ad"><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=mongoosejscom" id="_carbonads_js"></script></div></div></div><div class="container"><div id="content"><h1>Document</h1><div><div class="native-inline">
  <a href="#native_link#"><span class="sponsor">Sponsor</span> #native_company# â€” #native_desc#</a>
</div>
</div><div class="api-nav"><div class="api-nav-content"><div class="nav-item" id="nav-Mongoose"><div class="nav-item-title"><a href="mongoose.html">Mongoose</a></div></div><div class="nav-item" id="nav-Schema"><div class="nav-item-title"><a href="schema.html">Schema</a></div></div><div class="nav-item" id="nav-Connection"><div class="nav-item-title"><a href="connection.html">Connection</a></div></div><div class="nav-item" id="nav-Document"><div class="nav-item-title" style="font-weight: bold"><a href="document.html">Document</a></div><ul class="nav-item-sub"><li><a href="#document_Document-$ignore">Document.prototype.$ignore()</a></li><li><a href="#document_Document-$isDefault">Document.prototype.$isDefault()</a></li><li><a href="#document_Document-$isDeleted">Document.prototype.$isDeleted()</a></li><li><a href="#document_Document-$isEmpty">Document.prototype.$isEmpty()</a></li><li><a href="#document_Document-$locals">Document.prototype.$locals</a></li><li><a href="#document_Document-$markValid">Document.prototype.$markValid()</a></li><li><a href="#document_Document-$session">Document.prototype.$session()</a></li><li><a href="#document_Document-$set">Document.prototype.$set()</a></li><li><a href="#document_Document-depopulate">Document.prototype.depopulate()</a></li><li><a href="#document_Document-directModifiedPaths">Document.prototype.directModifiedPaths()</a></li><li><a href="#document_Document-equals">Document.prototype.equals()</a></li><li><a href="#document_Document-errors">Document.prototype.errors</a></li><li><a href="#document_Document-execPopulate">Document.prototype.execPopulate()</a></li><li><a href="#document_Document-get">Document.prototype.get()</a></li><li><a href="#document_Document-id">Document.prototype.id</a></li><li><a href="#document_Document-init">Document.prototype.init()</a></li><li><a href="#document_Document-inspect">Document.prototype.inspect()</a></li><li><a href="#document_Document-invalidate">Document.prototype.invalidate()</a></li><li><a href="#document_Document-isDirectModified">Document.prototype.isDirectModified()</a></li><li><a href="#document_Document-isDirectSelected">Document.prototype.isDirectSelected()</a></li><li><a href="#document_Document-isInit">Document.prototype.isInit()</a></li><li><a href="#document_Document-isModified">Document.prototype.isModified()</a></li><li><a href="#document_Document-isNew">Document.prototype.isNew</a></li><li><a href="#document_Document-isSelected">Document.prototype.isSelected()</a></li><li><a href="#document_Document-markModified">Document.prototype.markModified()</a></li><li><a href="#document_Document-modifiedPaths">Document.prototype.modifiedPaths()</a></li><li><a href="#document_Document-overwrite">Document.prototype.overwrite()</a></li><li><a href="#document_Document-populate">Document.prototype.populate()</a></li><li><a href="#document_Document-populated">Document.prototype.populated()</a></li><li><a href="#document_Document-replaceOne">Document.prototype.replaceOne()</a></li><li><a href="#document_Document-save">Document.prototype.save()</a></li><li><a href="#document_Document-schema">Document.prototype.schema</a></li><li><a href="#document_Document-set">Document.prototype.set()</a></li><li><a href="#document_Document-toJSON">Document.prototype.toJSON()</a></li><li><a href="#document_Document-toObject">Document.prototype.toObject()</a></li><li><a href="#document_Document-toString">Document.prototype.toString()</a></li><li><a href="#document_Document-unmarkModified">Document.prototype.unmarkModified()</a></li><li><a href="#document_Document-update">Document.prototype.update()</a></li><li><a href="#document_Document-updateOne">Document.prototype.updateOne()</a></li><li><a href="#document_Document-validate">Document.prototype.validate()</a></li><li><a href="#document_Document-validateSync">Document.prototype.validateSync()</a></li></ul></div><div class="nav-item" id="nav-Model"><div class="nav-item-title"><a href="model.html">Model</a></div></div><div class="nav-item" id="nav-Query"><div class="nav-item-title"><a href="query.html">Query</a></div></div><div class="nav-item" id="nav-QueryCursor"><div class="nav-item-title"><a href="querycursor.html">QueryCursor</a></div></div><div class="nav-item" id="nav-Aggregate"><div class="nav-item-title"><a href="aggregate.html">Aggregate</a></div></div><div class="nav-item" id="nav-AggregationCursor"><div class="nav-item-title"><a href="aggregationcursor.html">AggregationCursor</a></div></div><div class="nav-item" id="nav-Schematype"><div class="nav-item-title"><a href="schematype.html">Schematype</a></div></div><div class="nav-item" id="nav-Virtualtype"><div class="nav-item-title"><a href="virtualtype.html">Virtualtype</a></div></div><div class="nav-item" id="nav-Error"><div class="nav-item-title"><a href="error.html">Error</a></div></div><div class="nav-item" id="nav-Array"><div class="nav-item-title"><a href="array.html">Array</a></div></div></div></div><div class="api-content"><ul><li><a href="#document_Document-$ignore">Document.prototype.$ignore()</a></li><li><a href="#document_Document-$isDefault">Document.prototype.$isDefault()</a></li><li><a href="#document_Document-$isDeleted">Document.prototype.$isDeleted()</a></li><li><a href="#document_Document-$isEmpty">Document.prototype.$isEmpty()</a></li><li><a href="#document_Document-$locals">Document.prototype.$locals</a></li><li><a href="#document_Document-$markValid">Document.prototype.$markValid()</a></li><li><a href="#document_Document-$session">Document.prototype.$session()</a></li><li><a href="#document_Document-$set">Document.prototype.$set()</a></li><li><a href="#document_Document-depopulate">Document.prototype.depopulate()</a></li><li><a href="#document_Document-directModifiedPaths">Document.prototype.directModifiedPaths()</a></li><li><a href="#document_Document-equals">Document.prototype.equals()</a></li><li><a href="#document_Document-errors">Document.prototype.errors</a></li><li><a href="#document_Document-execPopulate">Document.prototype.execPopulate()</a></li><li><a href="#document_Document-get">Document.prototype.get()</a></li><li><a href="#document_Document-id">Document.prototype.id</a></li><li><a href="#document_Document-init">Document.prototype.init()</a></li><li><a href="#document_Document-inspect">Document.prototype.inspect()</a></li><li><a href="#document_Document-invalidate">Document.prototype.invalidate()</a></li><li><a href="#document_Document-isDirectModified">Document.prototype.isDirectModified()</a></li><li><a href="#document_Document-isDirectSelected">Document.prototype.isDirectSelected()</a></li><li><a href="#document_Document-isInit">Document.prototype.isInit()</a></li><li><a href="#document_Document-isModified">Document.prototype.isModified()</a></li><li><a href="#document_Document-isNew">Document.prototype.isNew</a></li><li><a href="#document_Document-isSelected">Document.prototype.isSelected()</a></li><li><a href="#document_Document-markModified">Document.prototype.markModified()</a></li><li><a href="#document_Document-modifiedPaths">Document.prototype.modifiedPaths()</a></li><li><a href="#document_Document-overwrite">Document.prototype.overwrite()</a></li><li><a href="#document_Document-populate">Document.prototype.populate()</a></li><li><a href="#document_Document-populated">Document.prototype.populated()</a></li><li><a href="#document_Document-replaceOne">Document.prototype.replaceOne()</a></li><li><a href="#document_Document-save">Document.prototype.save()</a></li><li><a href="#document_Document-schema">Document.prototype.schema</a></li><li><a href="#document_Document-set">Document.prototype.set()</a></li><li><a href="#document_Document-toJSON">Document.prototype.toJSON()</a></li><li><a href="#document_Document-toObject">Document.prototype.toObject()</a></li><li><a href="#document_Document-toString">Document.prototype.toString()</a></li><li><a href="#document_Document-unmarkModified">Document.prototype.unmarkModified()</a></li><li><a href="#document_Document-update">Document.prototype.update()</a></li><li><a href="#document_Document-updateOne">Document.prototype.updateOne()</a></li><li><a href="#document_Document-validate">Document.prototype.validate()</a></li><li><a href="#document_Document-validateSync">Document.prototype.validateSync()</a></li></ul><hr class="separate-api-elements"><h3 id="document_Document-$ignore"><a href="#document_Document-$ignore">Document.prototype.$ignore()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">path
<span class="method-type">&laquo;String&raquo;</span> the path to ignore</li></ul><div><p>Don't run validation on this path or persist changes to this path.</p>

<h4>Example:</h4>

<pre><code>doc.foo = <span class="hljs-literal">null</span>;
doc.$ignore(<span class="hljs-string">'foo'</span>);
doc.save(); <span class="hljs-comment">// changes to foo will not be persisted and validators won't be run</span></code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-$isDefault"><a href="#document_Document-$isDefault">Document.prototype.$isDefault()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">[path]
<span class="method-type">&laquo;String&raquo;</span> </li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Boolean&raquo;</span> </li></ul><div><p>Checks if a path is set to its default.</p>

<h4>Example</h4>

<pre><code>MyModel = mongoose.model(<span class="hljs-string">'test'</span>, { name: { type: <span class="hljs-built_in">String</span>, <span class="hljs-keyword">default</span>: <span class="hljs-string">'Val '</span>} });
<span class="hljs-keyword">var</span> m = <span class="hljs-keyword">new</span> MyModel();
m.$isDefault(<span class="hljs-string">'name'</span>); <span class="hljs-comment">// true</span></code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-$isDeleted"><a href="#document_Document-$isDeleted">Document.prototype.$isDeleted()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">[val]
<span class="method-type">&laquo;Boolean&raquo;</span> optional, overrides whether mongoose thinks the doc is deleted</li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Boolean&raquo;</span> whether mongoose thinks this doc is deleted.</li></ul><div><p>Getter/setter, determines whether the document was removed or not.</p>

<h4>Example:</h4>

<pre><code>product.remove(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, product</span>) </span>{
  product.$isDeleted(); <span class="hljs-comment">// true</span>
  product.remove(); <span class="hljs-comment">// no-op, doesn't send anything to the db</span>

  product.$isDeleted(<span class="hljs-literal">false</span>);
  product.$isDeleted(); <span class="hljs-comment">// false</span>
  product.remove(); <span class="hljs-comment">// will execute a remove against the db</span>
})</code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-$isEmpty"><a href="#document_Document-$isEmpty">Document.prototype.$isEmpty()</a></h3><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Boolean&raquo;</span> </li></ul><div><p>Returns true if the given path is nullish or only contains empty objects. Useful for determining whether this subdoc will get stripped out by the <a href="/docs/guide.html#minimize">minimize option</a>.</p>

<h4>Example:</h4>

<pre><code><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> Schema({ nested: { foo: <span class="hljs-built_in">String</span> } });
<span class="hljs-keyword">const</span> Model = mongoose.model(<span class="hljs-string">'Test'</span>, schema);
<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">new</span> Model({});
doc.$isEmpty(<span class="hljs-string">'nested'</span>); <span class="hljs-comment">// true</span>
doc.nested.$isEmpty(); <span class="hljs-comment">// true</span>

doc.nested.foo = <span class="hljs-string">'bar'</span>;
doc.$isEmpty(<span class="hljs-string">'nested'</span>); <span class="hljs-comment">// false</span>
doc.nested.$isEmpty(); <span class="hljs-comment">// false</span></code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-$locals"><a href="#document_Document-$locals">Document.prototype.$locals</a></h3><h5>Type:</h5><ul><li><span class="method-type">&laquo;property&raquo;</span></li></ul><div><p>Empty object that you can use for storing properties on the document. This is handy for passing data to middleware without conflicting with Mongoose internals.</p>

<h4>Example:</h4>

<pre><code>schema.pre(<span class="hljs-string">'save'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Mongoose will set `isNew` to `false` if `save()` succeeds</span>
  <span class="hljs-keyword">this</span>.$locals.wasNew = <span class="hljs-keyword">this</span>.isNew;
});

schema.post(<span class="hljs-string">'save'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Prints true if `isNew` was set before `save()`</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.$locals.wasNew);
});</code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-$markValid"><a href="#document_Document-$markValid">Document.prototype.$markValid()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">path
<span class="method-type">&laquo;String&raquo;</span> the field to mark as valid</li></ul><div><p>Marks a path as valid, removing existing validation errors.</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-$session"><a href="#document_Document-$session">Document.prototype.$session()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">[session]
<span class="method-type">&laquo;ClientSession&raquo;</span> overwrite the current session</li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;ClientSession&raquo;</span> </li></ul><div><p>Getter/setter around the session associated with this document. Used to automatically set <code>session</code> if you <code>save()</code> a doc that you got from a query with an associated session.</p>

<h4>Example:</h4>

<pre><code><span class="hljs-keyword">const</span> session = MyModel.startSession();
<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">await</span> MyModel.findOne().session(session);
doc.$session() === session; <span class="hljs-comment">// true</span>
doc.$session(<span class="hljs-literal">null</span>);
doc.$session() === <span class="hljs-literal">null</span>; <span class="hljs-comment">// true</span></code></pre>

<p>If this is a top-level document, setting the session propagates to all child docs.</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-$set"><a href="#document_Document-$set">Document.prototype.$set()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">path
<span class="method-type">&laquo;String|Object&raquo;</span> path or object of key/vals to set</li><li class="param">val
<span class="method-type">&laquo;Any&raquo;</span> the value to set</li><li class="param">[type]
<span class="method-type">&laquo;Schema|String|Number|Buffer|*&raquo;</span> optionally specify a type for &quot;on-the-fly&quot; attributes</li><li class="param">[options]
<span class="method-type">&laquo;Object&raquo;</span> optionally specify options that modify the behavior of the set</li></ul><div><p>Alias for <code>set()</code>, used internally to avoid conflicts</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-depopulate"><a href="#document_Document-depopulate">Document.prototype.depopulate()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">path
<span class="method-type">&laquo;String&raquo;</span> </li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Document&raquo;</span> this</li></ul><div><p>Takes a populated field and returns it to its unpopulated state.</p>

<h4>Example:</h4>

<pre><code>Model.findOne().populate(<span class="hljs-string">'author'</span>).exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, doc</span>) </span>{
  <span class="hljs-built_in">console</span>.log(doc.author.name); <span class="hljs-comment">// Dr.Seuss</span>
  <span class="hljs-built_in">console</span>.log(doc.depopulate(<span class="hljs-string">'author'</span>));
  <span class="hljs-built_in">console</span>.log(doc.author); <span class="hljs-comment">// '5144cf8050f071d979c118a7'</span>
})</code></pre>

<p>If the path was not populated, this is a no-op.</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-directModifiedPaths"><a href="#document_Document-directModifiedPaths">Document.prototype.directModifiedPaths()</a></h3><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Array&raquo;</span> </li></ul><div><p>Returns the list of paths that have been directly modified. A direct modified path is a path that you explicitly set, whether via <code>doc.foo = 'bar'</code>, <code>Object.assign(doc, { foo: 'bar' })</code>, or <code>doc.set('foo', 'bar')</code>.</p>

<p>A path <code>a</code> may be in <code>modifiedPaths()</code> but not in <code>directModifiedPaths()</code> because a child of <code>a</code> was directly modified.</p>

<h4>Example</h4>

<pre><code><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> Schema({ foo: <span class="hljs-built_in">String</span>, nested: { bar: <span class="hljs-built_in">String</span> } });
<span class="hljs-keyword">const</span> Model = mongoose.model(<span class="hljs-string">'Test'</span>, schema);
<span class="hljs-keyword">await</span> Model.create({ foo: <span class="hljs-string">'original'</span>, nested: { bar: <span class="hljs-string">'original'</span> } });

<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">await</span> Model.findOne();
doc.nested.bar = <span class="hljs-string">'modified'</span>;
doc.directModifiedPaths(); <span class="hljs-comment">// ['nested.bar']</span>
doc.modifiedPaths(); <span class="hljs-comment">// ['nested', 'nested.bar']</span></code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-equals"><a href="#document_Document-equals">Document.prototype.equals()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">doc
<span class="method-type">&laquo;Document&raquo;</span> a document to compare</li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Boolean&raquo;</span> </li></ul><div><p>Returns true if the Document stores the same data as doc.</p>

<p>Documents are considered equal when they have matching <code>_id</code>s, unless neither document has an <code>_id</code>, in which case this function falls back to using <code>deepEqual()</code>.</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-errors"><a href="#document_Document-errors">Document.prototype.errors</a></h3><h5>Type:</h5><ul><li><span class="method-type">&laquo;property&raquo;</span></li></ul><div><p>Hash containing current validation errors.</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-execPopulate"><a href="#document_Document-execPopulate">Document.prototype.execPopulate()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">[callback]
<span class="method-type">&laquo;Function&raquo;</span> optional callback. If specified, a promise will <strong>not</strong> be returned</li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Promise&raquo;</span> promise that resolves to the document when population is done</li></ul><div><p>Explicitly executes population and returns a promise. Useful for ES2015 integration.</p>

<h4>Example:</h4>

<pre><code><span class="hljs-keyword">var</span> promise = doc.
  populate(<span class="hljs-string">'company'</span>).
  populate({
    path: <span class="hljs-string">'notes'</span>,
    match: <span class="hljs-regexp">/airline/</span>,
    select: <span class="hljs-string">'text'</span>,
    model: <span class="hljs-string">'modelName'</span>
    options: opts
  }).
  execPopulate();

<span class="hljs-comment">// summary</span>
doc.execPopulate().then(resolve, reject);</code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-get"><a href="#document_Document-get">Document.prototype.get()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">path
<span class="method-type">&laquo;String&raquo;</span> </li><li class="param">[type]
<span class="method-type">&laquo;Schema|String|Number|Buffer|*&raquo;</span> optionally specify a type for on-the-fly attributes</li><li class="param">[options]
<span class="method-type">&laquo;Object&raquo;</span> </li><ul style="margin-top: 0.5em"><li>[options.virtuals=false]
<span class="method-type">&laquo;Boolean&raquo;</span> Apply virtuals before getting this path</li></ul><ul style="margin-top: 0.5em"><li>[options.getters=true]
<span class="method-type">&laquo;Boolean&raquo;</span> If false, skip applying getters and just get the raw value</li></ul></ul><div><p>Returns the value of a path.</p>

<h4>Example</h4>

<pre><code><span class="hljs-comment">// path</span>
doc.get(<span class="hljs-string">'age'</span>) <span class="hljs-comment">// 47</span>

<span class="hljs-comment">// dynamic casting to a string</span>
doc.get(<span class="hljs-string">'age'</span>, <span class="hljs-built_in">String</span>) <span class="hljs-comment">// "47"</span></code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-id"><a href="#document_Document-id">Document.prototype.id</a></h3><h5>Type:</h5><ul><li><span class="method-type">&laquo;property&raquo;</span></li></ul><div><p>The string version of this documents _id.</p>

<h4>Note:</h4>

<p>This getter exists on all documents by default. The getter can be disabled by setting the <code>id</code> <a href="/docs/guide.html#id">option</a> of its <code>Schema</code> to false at construction time.</p>

<pre><code><span class="hljs-keyword">new</span> Schema({ name: <span class="hljs-built_in">String</span> }, { id: <span class="hljs-literal">false</span> });</code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-init"><a href="#document_Document-init">Document.prototype.init()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">doc
<span class="method-type">&laquo;Object&raquo;</span> document returned by mongo</li></ul><div><p>Initializes the document without setters or marking anything modified.</p>

<p>Called internally after a document is returned from mongodb. Normally, you do <strong>not</strong> need to call this function on your own.</p>

<p>This function triggers <code>init</code> <a href="/docs/middleware.html">middleware</a>. Note that <code>init</code> hooks are <a href="/docs/middleware.html#synchronous">synchronous</a>.</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-inspect"><a href="#document_Document-inspect">Document.prototype.inspect()</a></h3><div><p>Helper for console.log</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-invalidate"><a href="#document_Document-invalidate">Document.prototype.invalidate()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">path
<span class="method-type">&laquo;String&raquo;</span> the field to invalidate</li><li class="param">errorMsg
<span class="method-type">&laquo;String|Error&raquo;</span> the error which states the reason <code>path</code> was invalid</li><li class="param">value
<span class="method-type">&laquo;Object|String|Number|any&raquo;</span> optional invalid value</li><li class="param">[kind]
<span class="method-type">&laquo;String&raquo;</span> optional <code>kind</code> property for the error</li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;ValidationError&raquo;</span> the current ValidationError, with all currently invalidated paths</li></ul><div><p>Marks a path as invalid, causing validation to fail.</p>

<p>The <code>errorMsg</code> argument will become the message of the <code>ValidationError</code>.</p>

<p>The <code>value</code> argument (if passed) will be available through the <code>ValidationError.value</code> property.</p>

<pre><code>doc.invalidate(<span class="hljs-string">'size'</span>, <span class="hljs-string">'must be less than 20'</span>, <span class="hljs-number">14</span>);

doc.validate(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
  <span class="hljs-built_in">console</span>.log(err)
  <span class="hljs-comment">// prints</span>
  { message: <span class="hljs-string">'Validation failed'</span>,
    name: <span class="hljs-string">'ValidationError'</span>,
    errors:
     { size:
        { message: <span class="hljs-string">'must be less than 20'</span>,
          name: <span class="hljs-string">'ValidatorError'</span>,
          path: <span class="hljs-string">'size'</span>,
          type: <span class="hljs-string">'user defined'</span>,
          value: <span class="hljs-number">14</span> } } }
})</code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-isDirectModified"><a href="#document_Document-isDirectModified">Document.prototype.isDirectModified()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">path
<span class="method-type">&laquo;String&raquo;</span> </li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Boolean&raquo;</span> </li></ul><div><p>Returns true if <code>path</code> was directly set and modified, else false.</p>

<h4>Example</h4>

<pre><code>doc.set(<span class="hljs-string">'documents.0.title'</span>, <span class="hljs-string">'changed'</span>);
doc.isDirectModified(<span class="hljs-string">'documents.0.title'</span>) <span class="hljs-comment">// true</span>
doc.isDirectModified(<span class="hljs-string">'documents'</span>) <span class="hljs-comment">// false</span></code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-isDirectSelected"><a href="#document_Document-isDirectSelected">Document.prototype.isDirectSelected()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">path
<span class="method-type">&laquo;String&raquo;</span> </li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Boolean&raquo;</span> </li></ul><div><p>Checks if <code>path</code> was explicitly selected. If no projection, always returns true.</p>

<h4>Example</h4>

<pre><code>Thing.findOne().select(<span class="hljs-string">'nested.name'</span>).exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, doc</span>) </span>{
   doc.isDirectSelected(<span class="hljs-string">'nested.name'</span>) <span class="hljs-comment">// true</span>
   doc.isDirectSelected(<span class="hljs-string">'nested.otherName'</span>) <span class="hljs-comment">// false</span>
   doc.isDirectSelected(<span class="hljs-string">'nested'</span>)  <span class="hljs-comment">// false</span>
})</code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-isInit"><a href="#document_Document-isInit">Document.prototype.isInit()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">path
<span class="method-type">&laquo;String&raquo;</span> </li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Boolean&raquo;</span> </li></ul><div><p>Checks if <code>path</code> was initialized.</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-isModified"><a href="#document_Document-isModified">Document.prototype.isModified()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">[path]
<span class="method-type">&laquo;String&raquo;</span> optional</li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Boolean&raquo;</span> </li></ul><div><p>Returns true if this document was modified, else false.</p>

<p>If <code>path</code> is given, checks if a path or any full path containing <code>path</code> as part of its path chain has been modified.</p>

<h4>Example</h4>

<pre><code>doc.set(<span class="hljs-string">'documents.0.title'</span>, <span class="hljs-string">'changed'</span>);
doc.isModified()                      <span class="hljs-comment">// true</span>
doc.isModified(<span class="hljs-string">'documents'</span>)           <span class="hljs-comment">// true</span>
doc.isModified(<span class="hljs-string">'documents.0.title'</span>)   <span class="hljs-comment">// true</span>
doc.isModified(<span class="hljs-string">'documents otherProp'</span>) <span class="hljs-comment">// true</span>
doc.isDirectModified(<span class="hljs-string">'documents'</span>)     <span class="hljs-comment">// false</span></code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-isNew"><a href="#document_Document-isNew">Document.prototype.isNew</a></h3><h5>Type:</h5><ul><li><span class="method-type">&laquo;property&raquo;</span></li></ul><div><p>Boolean flag specifying if the document is new.</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-isSelected"><a href="#document_Document-isSelected">Document.prototype.isSelected()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">path
<span class="method-type">&laquo;String&raquo;</span> </li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Boolean&raquo;</span> </li></ul><div><p>Checks if <code>path</code> was selected in the source query which initialized this document.</p>

<h4>Example</h4>

<pre><code>Thing.findOne().select(<span class="hljs-string">'name'</span>).exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, doc</span>) </span>{
   doc.isSelected(<span class="hljs-string">'name'</span>) <span class="hljs-comment">// true</span>
   doc.isSelected(<span class="hljs-string">'age'</span>)  <span class="hljs-comment">// false</span>
})</code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-markModified"><a href="#document_Document-markModified">Document.prototype.markModified()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">path
<span class="method-type">&laquo;String&raquo;</span> the path to mark modified</li><li class="param">[scope]
<span class="method-type">&laquo;Document&raquo;</span> the scope to run validators with</li></ul><div><p>Marks the path as having pending changes to write to the db.</p>

<p><em>Very helpful when using <a href="./schematypes.html#mixed">Mixed</a> types.</em></p>

<h4>Example:</h4>

<pre><code>doc.mixed.type = <span class="hljs-string">'changed'</span>;
doc.markModified(<span class="hljs-string">'mixed.type'</span>);
doc.save() <span class="hljs-comment">// changes to mixed.type are now persisted</span></code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-modifiedPaths"><a href="#document_Document-modifiedPaths">Document.prototype.modifiedPaths()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">[options]
<span class="method-type">&laquo;Object&raquo;</span> </li><ul style="margin-top: 0.5em"><li>[options.includeChildren=false]
<span class="method-type">&laquo;Boolean&raquo;</span> if true, returns children of modified paths as well. For example, if false, the list of modified paths for <code>doc.colors = { primary: &#39;blue&#39; };</code> will <strong>not</strong> contain <code>colors.primary</code>. If true, <code>modifiedPaths()</code> will return an array that contains <code>colors.primary</code>.</li></ul></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Array&raquo;</span> </li></ul><div><p>Returns the list of paths that have been modified.</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-overwrite"><a href="#document_Document-overwrite">Document.prototype.overwrite()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">obj
<span class="method-type">&laquo;Object&raquo;</span> the object to overwrite this document with</li></ul><div><p>Overwrite all values in this document with the values of <code>obj</code>, except for immutable properties. Behaves similarly to <code>set()</code>, except for it unsets all properties that aren't in <code>obj</code>.</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-populate"><a href="#document_Document-populate">Document.prototype.populate()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">[path]
<span class="method-type">&laquo;String|Object&raquo;</span> The path to populate or an options object</li><li class="param">[callback]
<span class="method-type">&laquo;Function&raquo;</span> When passed, population is invoked</li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Document&raquo;</span> this</li></ul><div><p>Populates document references, executing the <code>callback</code> when complete. If you want to use promises instead, use this function with <a href="#document_Document-execPopulate"><code>execPopulate()</code></a></p>

<h4>Example:</h4>

<pre><code>doc
.populate(<span class="hljs-string">'company'</span>)
.populate({
  path: <span class="hljs-string">'notes'</span>,
  match: <span class="hljs-regexp">/airline/</span>,
  select: <span class="hljs-string">'text'</span>,
  model: <span class="hljs-string">'modelName'</span>
  options: opts
}, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, user</span>) </span>{
  assert(doc._id === user._id) <span class="hljs-comment">// the document itself is passed</span>
})

<span class="hljs-comment">// summary</span>
doc.populate(path)                   <span class="hljs-comment">// not executed</span>
doc.populate(options);               <span class="hljs-comment">// not executed</span>
doc.populate(path, callback)         <span class="hljs-comment">// executed</span>
doc.populate(options, callback);     <span class="hljs-comment">// executed</span>
doc.populate(callback);              <span class="hljs-comment">// executed</span>
doc.populate(options).execPopulate() <span class="hljs-comment">// executed, returns promise</span></code></pre>

<h4>NOTE:</h4>

<p>Population does not occur unless a <code>callback</code> is passed <em>or</em> you explicitly call <code>execPopulate()</code>. Passing the same path a second time will overwrite the previous path options. See <a href="#model_Model.populate">Model.populate()</a> for explaination of options.</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-populated"><a href="#document_Document-populated">Document.prototype.populated()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">path
<span class="method-type">&laquo;String&raquo;</span> </li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Array,ObjectId,Number,Buffer,String,undefined&raquo;</span> </li></ul><div><p>Gets _id(s) used during population of the given <code>path</code>.</p>

<h4>Example:</h4>

<pre><code>Model.findOne().populate(<span class="hljs-string">'author'</span>).exec(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, doc</span>) </span>{
  <span class="hljs-built_in">console</span>.log(doc.author.name)         <span class="hljs-comment">// Dr.Seuss</span>
  <span class="hljs-built_in">console</span>.log(doc.populated(<span class="hljs-string">'author'</span>)) <span class="hljs-comment">// '5144cf8050f071d979c118a7'</span>
})</code></pre>

<p>If the path was not populated, undefined is returned.</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-replaceOne"><a href="#document_Document-replaceOne">Document.prototype.replaceOne()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">doc
<span class="method-type">&laquo;Object&raquo;</span> </li><li class="param">options
<span class="method-type">&laquo;Object&raquo;</span> </li><li class="param">callback
<span class="method-type">&laquo;Function&raquo;</span> </li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Query&raquo;</span> </li></ul><div><p>Sends a replaceOne command with this document <code>_id</code> as the query selector.</p>

<h4>Valid options:</h4>

<ul>
<li>same as in <a href="#model_Model.replaceOne">Model.replaceOne</a></li>
</ul>  </div><hr class="separate-api-elements"><h3 id="document_Document-save"><a href="#document_Document-save">Document.prototype.save()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">[options]
<span class="method-type">&laquo;Object&raquo;</span> options optional options</li><ul style="margin-top: 0.5em"><li>[options.safe]
<span class="method-type">&laquo;Object&raquo;</span> (DEPRECATED) overrides <a href="http://mongoosejs.com//docs/guide.html#safe">schema&#39;s safe option</a></li></ul><ul style="margin-top: 0.5em"><li>[options.validateBeforeSave]
<span class="method-type">&laquo;Boolean&raquo;</span> set to false to save without validating.</li></ul><li class="param">[fn]
<span class="method-type">&laquo;Function&raquo;</span> optional callback</li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Promise,undefined&raquo;</span> Returns undefined if used with callback or a Promise otherwise.</li></ul><div><p>Saves this document.</p>

<h4>Example:</h4>

<pre><code>product.sold = <span class="hljs-built_in">Date</span>.now();
product.save(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, product</span>) </span>{
  <span class="hljs-keyword">if</span> (err) ..
})</code></pre>

<p>The callback will receive two parameters</p>

<ol>
<li><code>err</code> if an error occurred</li>
<li><code>product</code> which is the saved <code>product</code></li>
</ol>

<p>As an extra measure of flow control, save will return a Promise.</p>

<h4>Example:</h4>

<pre><code>product.save().then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">product</span>) </span>{
   ...
});</code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-schema"><a href="#document_Document-schema">Document.prototype.schema</a></h3><h5>Type:</h5><ul><li><span class="method-type">&laquo;property&raquo;</span></li></ul><div><p>The documents schema.</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-set"><a href="#document_Document-set">Document.prototype.set()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">path
<span class="method-type">&laquo;String|Object&raquo;</span> path or object of key/vals to set</li><li class="param">val
<span class="method-type">&laquo;Any&raquo;</span> the value to set</li><li class="param">[type]
<span class="method-type">&laquo;Schema|String|Number|Buffer|*&raquo;</span> optionally specify a type for &quot;on-the-fly&quot; attributes</li><li class="param">[options]
<span class="method-type">&laquo;Object&raquo;</span> optionally specify options that modify the behavior of the set</li></ul><div><p>Sets the value of a path, or many paths.</p>

<h4>Example:</h4>

<pre><code><span class="hljs-comment">// path, value</span>
doc.set(path, value)

<span class="hljs-comment">// object</span>
doc.set({
    path  : value
  , path2 : {
       path  : value
    }
})

<span class="hljs-comment">// on-the-fly cast to number</span>
doc.set(path, value, <span class="hljs-built_in">Number</span>)

<span class="hljs-comment">// on-the-fly cast to string</span>
doc.set(path, value, <span class="hljs-built_in">String</span>)

<span class="hljs-comment">// changing strict mode behavior</span>
doc.set(path, value, { strict: <span class="hljs-literal">false</span> });</code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-toJSON"><a href="#document_Document-toJSON">Document.prototype.toJSON()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">options
<span class="method-type">&laquo;Object&raquo;</span> </li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Object&raquo;</span> </li></ul><div><p>The return value of this method is used in calls to JSON.stringify(doc).</p>

<p>This method accepts the same options as <a href="#document_Document-toObject">Document#toObject</a>. To apply the options to every document of your schema by default, set your <a href="#schema_Schema">schemas</a> <code>toJSON</code> option to the same argument.</p>

<pre><code>schema.set(<span class="hljs-string">'toJSON'</span>, { virtuals: <span class="hljs-literal">true</span> })</code></pre>

<p>See <a href="/docs/guide.html#toJSON">schema options</a> for details.</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-toObject"><a href="#document_Document-toObject">Document.prototype.toObject()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">[options]
<span class="method-type">&laquo;Object&raquo;</span> </li><ul style="margin-top: 0.5em"><li>[options.getters=false]
<span class="method-type">&laquo;Boolean&raquo;</span> if true, apply all getters, including virtuals</li></ul><ul style="margin-top: 0.5em"><li>[options.virtuals=false]
<span class="method-type">&laquo;Boolean&raquo;</span> if true, apply virtuals. Use <code>{ getters: true, virtuals: false }</code> to just apply getters, not virtuals</li></ul><ul style="margin-top: 0.5em"><li>[options.minimize=true]
<span class="method-type">&laquo;Boolean&raquo;</span> if true, omit any empty objects from the output</li></ul><ul style="margin-top: 0.5em"><li>[options.transform=null]
<span class="method-type">&laquo;Function|null&raquo;</span> if set, mongoose will call this function to allow you to transform the returned object</li></ul><ul style="margin-top: 0.5em"><li>[options.depopulate=false]
<span class="method-type">&laquo;Boolean&raquo;</span> if true, replace any conventionally populated paths with the original id in the output. Has no affect on virtual populated paths.</li></ul><ul style="margin-top: 0.5em"><li>[options.versionKey=true]
<span class="method-type">&laquo;Boolean&raquo;</span> if false, exclude the version key (<code>__v</code> by default) from the output</li></ul><ul style="margin-top: 0.5em"><li>[options.flattenMaps=false]
<span class="method-type">&laquo;Boolean&raquo;</span> if true, convert Maps to POJOs. Useful if you want to <code>JSON.stringify()</code> the result of <code>toObject()</code>.</li></ul></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Object&raquo;</span> js object</li></ul><div><p>Converts this document into a plain javascript object, ready for storage in MongoDB.</p>

<p>Buffers are converted to instances of <a href="http://mongodb.github.com/node-mongodb-native/api-bson-generated/binary.html">mongodb.Binary</a> for proper storage.</p>

<h4>Options:</h4>

<ul>
<li><code>getters</code> apply all getters (path and virtual getters), defaults to false</li>
<li><code>virtuals</code> apply virtual getters (can override <code>getters</code> option), defaults to false</li>
<li><code>minimize</code> remove empty objects (defaults to true)</li>
<li><code>transform</code> a transform function to apply to the resulting document before returning</li>
<li><code>depopulate</code> depopulate any populated paths, replacing them with their original refs (defaults to false)</li>
<li><code>versionKey</code> whether to include the version key (defaults to true)</li>
</ul>

<h4>Getters/Virtuals</h4>

<p>Example of only applying path getters</p>

<pre><code>doc.toObject({ getters: <span class="hljs-literal">true</span>, virtuals: <span class="hljs-literal">false</span> })</code></pre>

<p>Example of only applying virtual getters</p>

<pre><code>doc.toObject({ virtuals: <span class="hljs-literal">true</span> })</code></pre>

<p>Example of applying both path and virtual getters</p>

<pre><code>doc.toObject({ getters: <span class="hljs-literal">true</span> })</code></pre>

<p>To apply these options to every document of your schema by default, set your <a href="#schema_Schema">schemas</a> <code>toObject</code> option to the same argument.</p>

<pre><code>schema.set(<span class="hljs-string">'toObject'</span>, { virtuals: <span class="hljs-literal">true</span> })</code></pre>

<h4>Transform</h4>

<p>We may need to perform a transformation of the resulting object based on some criteria, say to remove some sensitive information or return a custom object. In this case we set the optional <code>transform</code> function.</p>

<p>Transform functions receive three arguments</p>

<pre><code><span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">doc, ret, options</span>) </span>{}</code></pre>

<ul>
<li><code>doc</code> The mongoose document which is being converted</li>
<li><code>ret</code> The plain object representation which has been converted</li>
<li><code>options</code> The options in use (either schema options or the options passed inline)</li>
</ul>

<h4>Example</h4>

<pre><code><span class="hljs-comment">// specify the transform schema option</span>
<span class="hljs-keyword">if</span> (!schema.options.toObject) schema.options.toObject = {};
schema.options.toObject.transform = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">doc, ret, options</span>) </span>{
  <span class="hljs-comment">// remove the _id of every document before returning the result</span>
  <span class="hljs-keyword">delete</span> ret._id;
  <span class="hljs-keyword">return</span> ret;
}

<span class="hljs-comment">// without the transformation in the schema</span>
doc.toObject(); <span class="hljs-comment">// { _id: 'anId', name: 'Wreck-it Ralph' }</span>

<span class="hljs-comment">// with the transformation</span>
doc.toObject(); <span class="hljs-comment">// { name: 'Wreck-it Ralph' }</span></code></pre>

<p>With transformations we can do a lot more than remove properties. We can even return completely new customized objects:</p>

<pre><code><span class="hljs-keyword">if</span> (!schema.options.toObject) schema.options.toObject = {};
schema.options.toObject.transform = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">doc, ret, options</span>) </span>{
  <span class="hljs-keyword">return</span> { movie: ret.name }
}

<span class="hljs-comment">// without the transformation in the schema</span>
doc.toObject(); <span class="hljs-comment">// { _id: 'anId', name: 'Wreck-it Ralph' }</span>

<span class="hljs-comment">// with the transformation</span>
doc.toObject(); <span class="hljs-comment">// { movie: 'Wreck-it Ralph' }</span></code></pre>

<p><em>Note: if a transform function returns <code>undefined</code>, the return value will be ignored.</em></p>

<p>Transformations may also be applied inline, overridding any transform set in the options:</p>

<pre><code><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">xform</span> (<span class="hljs-params">doc, ret, options</span>) </span>{
  <span class="hljs-keyword">return</span> { inline: ret.name, custom: <span class="hljs-literal">true</span> }
}

<span class="hljs-comment">// pass the transform as an inline option</span>
doc.toObject({ transform: xform }); <span class="hljs-comment">// { inline: 'Wreck-it Ralph', custom: true }</span></code></pre>

<p>If you want to skip transformations, use <code>transform: false</code>:</p>

<pre><code><span class="hljs-keyword">if</span> (!schema.options.toObject) schema.options.toObject = {};
schema.options.toObject.hide = <span class="hljs-string">'_id'</span>;
schema.options.toObject.transform = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">doc, ret, options</span>) </span>{
  <span class="hljs-keyword">if</span> (options.hide) {
    options.hide.split(<span class="hljs-string">' '</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">prop</span>) </span>{
      <span class="hljs-keyword">delete</span> ret[prop];
    });
  }
  <span class="hljs-keyword">return</span> ret;
}

<span class="hljs-keyword">var</span> doc = <span class="hljs-keyword">new</span> Doc({ _id: <span class="hljs-string">'anId'</span>, secret: <span class="hljs-number">47</span>, name: <span class="hljs-string">'Wreck-it Ralph'</span> });
doc.toObject();                                        <span class="hljs-comment">// { secret: 47, name: 'Wreck-it Ralph' }</span>
doc.toObject({ hide: <span class="hljs-string">'secret _id'</span>, transform: <span class="hljs-literal">false</span> });<span class="hljs-comment">// { _id: 'anId', secret: 47, name: 'Wreck-it Ralph' }</span>
doc.toObject({ hide: <span class="hljs-string">'secret _id'</span>, transform: <span class="hljs-literal">true</span> }); <span class="hljs-comment">// { name: 'Wreck-it Ralph' }</span></code></pre>

<p>Transforms are applied <em>only to the document and are not applied to sub-documents</em>.</p>

<p>Transforms, like all of these options, are also available for <code>toJSON</code>. See <a href="https://thecodebarbarian.com/the-80-20-guide-to-json-stringify-in-javascript.html">this guide to <code>JSON.stringify()</code></a> to learn why <code>toJSON()</code> and <code>toObject()</code> are separate functions.</p>

<p>See <a href="/docs/guide.html#toObject">schema options</a> for some more details.</p>

<p><em>During save, no custom options are applied to the document before being sent to the database.</em></p>  </div><hr class="separate-api-elements"><h3 id="document_Document-toString"><a href="#document_Document-toString">Document.prototype.toString()</a></h3><div><p>Helper for console.log</p>  </div><hr class="separate-api-elements"><h3 id="document_Document-unmarkModified"><a href="#document_Document-unmarkModified">Document.prototype.unmarkModified()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">path
<span class="method-type">&laquo;String&raquo;</span> the path to unmark modified</li></ul><div><p>Clears the modified state on the specified path.</p>

<h4>Example:</h4>

<pre><code>doc.foo = <span class="hljs-string">'bar'</span>;
doc.unmarkModified(<span class="hljs-string">'foo'</span>);
doc.save(); <span class="hljs-comment">// changes to foo will not be persisted</span></code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-update"><a href="#document_Document-update">Document.prototype.update()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">doc
<span class="method-type">&laquo;Object&raquo;</span> </li><li class="param">options
<span class="method-type">&laquo;Object&raquo;</span> </li><li class="param">callback
<span class="method-type">&laquo;Function&raquo;</span> </li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Query&raquo;</span> </li></ul><div><p>Sends an update command with this document <code>_id</code> as the query selector.</p>

<h4>Example:</h4>

<pre><code>weirdCar.update({$inc: {wheels:<span class="hljs-number">1</span>}}, { w: <span class="hljs-number">1</span> }, callback);</code></pre>

<h4>Valid options:</h4>

<ul>
<li>same as in <a href="#model_Model.update">Model.update</a></li>
</ul>  </div><hr class="separate-api-elements"><h3 id="document_Document-updateOne"><a href="#document_Document-updateOne">Document.prototype.updateOne()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">doc
<span class="method-type">&laquo;Object&raquo;</span> </li><li class="param">options
<span class="method-type">&laquo;Object&raquo;</span> </li><li class="param">callback
<span class="method-type">&laquo;Function&raquo;</span> </li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Query&raquo;</span> </li></ul><div><p>Sends an updateOne command with this document <code>_id</code> as the query selector.</p>

<h4>Example:</h4>

<pre><code>weirdCar.updateOne({$inc: {wheels:<span class="hljs-number">1</span>}}, { w: <span class="hljs-number">1</span> }, callback);</code></pre>

<h4>Valid options:</h4>

<ul>
<li>same as in <a href="#model_Model.updateOne">Model.updateOne</a></li>
</ul>  </div><hr class="separate-api-elements"><h3 id="document_Document-validate"><a href="#document_Document-validate">Document.prototype.validate()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">optional
<span class="method-type">&laquo;Object&raquo;</span> options internal options</li><li class="param">callback
<span class="method-type">&laquo;Function&raquo;</span> optional callback called after validation completes, passing an error if one occurred</li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;Promise&raquo;</span> Promise</li></ul><div><p>Executes registered validation rules for this document.</p>

<h4>Note:</h4>

<p>This method is called <code>pre</code> save and if a validation rule is violated, <a href="#model_Model-save">save</a> is aborted and the error is returned to your <code>callback</code>.</p>

<h4>Example:</h4>

<pre><code>doc.validate(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) </span>{
  <span class="hljs-keyword">if</span> (err) handleError(err);
  <span class="hljs-keyword">else</span> <span class="hljs-comment">// validation passed</span>
});</code></pre>  </div><hr class="separate-api-elements"><h3 id="document_Document-validateSync"><a href="#document_Document-validateSync">Document.prototype.validateSync()</a></h3><h5>Parameters</h5><ul class="params"><li class="param">pathsToValidate
<span class="method-type">&laquo;Array|string&raquo;</span> only validate the given paths</li></ul><h5>Returns:</h5><ul><li><span class="method-type">&laquo;ValidationError,undefined&raquo;</span> ValidationError if there are errors during validation, or undefined if there is no error.</li></ul><div><p>Executes registered validation rules (skipping asynchronous validators) for this document.</p>

<h4>Note:</h4>

<p>This method is useful if you need synchronous validation.</p>

<h4>Example:</h4>

<pre><code><span class="hljs-keyword">var</span> err = doc.validateSync();
<span class="hljs-keyword">if</span> ( err ){
  handleError( err );
} <span class="hljs-keyword">else</span> {
  <span class="hljs-comment">// validation passed</span>
}</code></pre>  </div></div><script>_native.init("CK7DT53U",{
  targetClass: 'native-inline'
});</script></div></div><script type="text/javascript">var xhr = new XMLHttpRequest();
xhr.open('POST', 'https://g0a3nbw0xa.execute-api.us-east-1.amazonaws.com/prod/track', true);
xhr.setRequestHeader('Content-Type', 'application/json');
xhr.onreadystatechange = function() {};
xhr.send(JSON.stringify({
  path: window.location.pathname,
  hostname: window.location.hostname,
  hash: window.location.hash
}));</script><script type="text/javascript" src="/docs/js/navbar-search.js"></script><script type="text/javascript">(function (window, document) {
  var layout   = document.getElementById('layout'),
      menu     = document.getElementById('menu'),
      menuLink = document.getElementById('menuLink'),
      content  = document.getElementById('content');

  function toggleClass(element, className) {
      var classes = element.className.split(/\s+/),
          length = classes.length,
          i = 0;

      for(; i < length; i++) {
        if (classes[i] === className) {
          classes.splice(i, 1);
          break;
        }
      }
      // The className is not found
      if (length === classes.length) {
          classes.push(className);
      }

      element.className = classes.join(' ');
  }

  function toggleAll(e) {
      var active = 'active';

      e.preventDefault();
      toggleClass(layout, active);
      toggleClass(menu, active);
      toggleClass(menuLink, active);
  }

  menuLink.onclick = function (e) {
      toggleAll(e);
  };

  content.onclick = function(e) {
      if (menu.className.indexOf('active') !== -1) {
          toggleAll(e);
      }
  };

}(this, this.document));</script></div></body></html>