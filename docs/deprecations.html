<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Mongoose v6.1.4: Deprecation Warnings</title><link rel="apple-touch-icon" sizes="57x57" href="images/favicon/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="images/favicon/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="images/favicon/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="images/favicon/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="images/favicon/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="images/favicon/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="images/favicon/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="images/favicon/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="images/favicon/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="images/favicon/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="images/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="images/favicon/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="images/favicon/favicon-16x16.png"><link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css" integrity="sha384-nn4HPE8lTHyVtfCBi5yW9d20FjT8BJwUXyWZT9InLYax14RDjBj46LmSztkmNP9w" crossorigin="anonymous"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans"><link rel="stylesheet" href="/docs/css/github.css"><link rel="stylesheet" href="/docs/css/mongoose5.css"><link rel="apple-touch-icon" sizes="57x57" href="images/favicon/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="images/favicon/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="images/favicon/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="images/favicon/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="images/favicon/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="images/favicon/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="images/favicon/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="images/favicon/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="images/favicon/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="images/favicon/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="images/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="images/favicon/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="images/favicon/favicon-16x16.png"><link rel="manifest" href="images/favicon/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="images/favicon/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="/docs/css/inlinecpc.css"><script type="text/javascript" src="//m.servedby-buysellads.com/monetization.custom.js"></script><style>p { line-height: 1.5em }
</style></head><body><div id="layout"><div id="mobile-menu"><a class="menu-link" id="menuLink" href="#menu"><span></span></a><div id="mobile-logo-container"><a href="/"><img id="logo" src="/docs/images/mongoose5_62x30_transparent.png"><span class="logo-text">mongoose</span></a></div></div><div id="menu"><div class="pure-menu"><div class="pure-menu-heading" id="logo-container"><a href="/"><img id="logo" src="/docs/images/mongoose5_62x30_transparent.png"><span class="logo-text">mongoose</span></a></div><ul class="pure-menu-list" id="navbar"><li class="pure-menu-horizontal pure-menu-item pure-menu-has-children pure-menu-allow-hover version"><a class="pure-menu-link" href="#">Version 6.1.4</a><ul class="pure-menu-children"><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/5.x">Version 5.13.14</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/4.x">Version 4.13.21</a></li></ul></li><li class="pure-menu-item search"><input id="search-input-nav" type="text" placeholder="Search"><button id="search-button-nav"><img src="/docs/images/search.svg"></button></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/index.html">Quick Start</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/guides.html">Guides</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/guide.html">Schemas</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/schematypes.html">SchemaTypes</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/connections.html">Connections</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/models.html">Models</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/documents.html">Documents</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/subdocs.html">Subdocuments</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/queries.html">Queries</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/validation.html">Validation</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/middleware.html">Middleware</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/populate.html">Populate</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/discriminators.html">Discriminators</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/plugins.html">Plugins</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/transactions.html">Transactions</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/typescript.html">TypeScript</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/api.html">API</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/mongoose.html">Mongoose</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/schema.html">Schema</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/connection.html">Connection</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/document.html">Document</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/model.html">Model</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/query.html">Query</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/aggregate.html">Aggregate</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/schematype.html">SchemaType</a></li><li class="pure-menu-item sub-item"><a class="pure-menu-link" href="/docs/api/virtualtype.html">VirtualType</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/migrating_to_6.html">Migration Guide</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/compatibility.html">Version Compatibility</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/faq.html">FAQ</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/further_reading.html">Further Reading</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/enterprise.html">For Enterprise</a></li><li class="pure-menu-item"><a class="pure-menu-link" href="/docs/sponsors.html" >Sponsors</a></li></ul><div class="cpc-ad"><script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CKYIL27I&placement=mongoosejscom" id="_carbonads_js"></script></div></div></div><div class="container"><div id="content"><a class="edit-docs-link" href="https://github.com/Automattic/mongoose/blob/master/docs/deprecations.md" target="_blank">
<img src="/docs/images/pencil.svg" />
</a><h1 id="deprecation-warnings">
      <a href="#deprecation-warnings">
        Deprecation Warnings
      </a>
    </h1>
<div id="native-direct"></div>
<script>
    (function() {
        if (typeof _bsa !== 'undefined' && _bsa) {
            _bsa.init('custom', 'CK7DT53U', 'placement:mongoosejscom', {
                target: '#native-direct',
                template: `
<div class="native-inline">
<a rel="sponsored noopener" target="_blank" href="##statlink##" title="##company## — ##tagline##"><span class="sponsor">Sponsor</span> ##company## — ##description##</a>
</div>
</a>
`
            });
        }
    })();
</script>

<p>There are several deprecations in the <a href="http://npmjs.com/package/mongodb">MongoDB Node.js driver</a>
that Mongoose users should be aware of. Mongoose provides options to work
around these deprecation warnings, but you need to test whether these options
cause any problems for your application. Please <a href="https://github.com/Automattic/mongoose/issues/new">report any issues on GitHub</a>.</p>
<h2 id="summary"><a href="#summary">Summary</a></h2>

<p>To fix all deprecation warnings, follow the below steps:</p>
<ul>
<li>Replace <code>update()</code> with <code>updateOne()</code>, <code>updateMany()</code>, or <code>replaceOne()</code></li>
<li>Replace <code>remove()</code> with <code>deleteOne()</code> or <code>deleteMany()</code>.</li>
<li>Replace <code>count()</code> with <code>countDocuments()</code>, unless you want to count how many documents are in the whole collection (no filter). In the latter case, use <code>estimatedDocumentCount()</code>.</li>
</ul>
<p>Read below for more a more detailed description of each deprecation warning.</p>
<h2 id="remove"><a href="#remove"><code>remove()</code></a></h2>

<p>The MongoDB driver&#39;s <a href="http://mongodb.github.io/node-mongodb-native/3.1/api/Collection.html#remove"><code>remove()</code> function</a> is deprecated in favor of <code>deleteOne()</code> and <code>deleteMany()</code>. This is to comply with
the <a href="https://github.com/mongodb/specifications/blob/master/source/crud/crud.rst">MongoDB CRUD specification</a>,
which aims to provide a consistent API for CRUD operations across all MongoDB
drivers.</p>
<pre><code>DeprecationWarning: collection.remove is deprecated. Use deleteOne,
deleteMany, or bulkWrite instead.
</code></pre>
<p>To remove this deprecation warning, replace any usage of <code>remove()</code> with
<code>deleteMany()</code>, <em>unless</em> you specify the <a href="/docs/api.html#model_Model.remove"><code>single</code> option to <code>remove()</code></a>. The <code>single</code>
option limited <code>remove()</code> to deleting at most one document, so you should
replace <code>remove(filter, { single: true })</code> with <code>deleteOne(filter)</code>.</p>
<pre><code class="language-javascript"><span class="hljs-comment">// Replace this:</span>
MyModel.remove({ <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span> });
<span class="hljs-comment">// With this:</span>
MyModel.deleteMany({ <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span> });

<span class="hljs-comment">// Replace this:</span>
MyModel.remove({ <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> }, { <span class="hljs-attr">single</span>: <span class="hljs-literal">true</span> });
<span class="hljs-comment">// With this:</span>
MyModel.deleteOne({ <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> });
</code></pre>
<h2 id="update"><a href="#update"><code>update()</code></a></h2>

<p>Like <code>remove()</code>, the <a href="/docs/api.html#model_Model.update"><code>update()</code> function</a> is deprecated in favor
of the more explicit <a href="/docs/api.html#model_Model.updateOne"><code>updateOne()</code></a>, <a href="/docs/api.html#model_Model.updateMany"><code>updateMany()</code></a>, and <a href="/docs/api.html#model_Model.replaceOne"><code>replaceOne()</code></a> functions. You should replace
<code>update()</code> with <code>updateOne()</code>, unless you use the <a href="/docs/api.html#model_Model.update"><code>multi</code> or <code>overwrite</code> options</a>.</p>
<pre><code>collection.update is deprecated. Use updateOne, updateMany, or bulkWrite
instead.
</code></pre>
<pre><code class="language-javascript"><span class="hljs-comment">// Replace this:</span>
MyModel.update({ <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span> }, { <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> });
<span class="hljs-comment">// With this:</span>
MyModel.updateOne({ <span class="hljs-attr">foo</span>: <span class="hljs-string">'bar'</span> }, { <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> });

<span class="hljs-comment">// If you use `overwrite: true`, you should use `replaceOne()` instead:</span>
MyModel.update(filter, update, { <span class="hljs-attr">overwrite</span>: <span class="hljs-literal">true</span> });
<span class="hljs-comment">// Replace with this:</span>
MyModel.replaceOne(filter, update);

<span class="hljs-comment">// If you use `multi: true`, you should use `updateMany()` instead:</span>
MyModel.update(filter, update, { <span class="hljs-attr">multi</span>: <span class="hljs-literal">true</span> });
<span class="hljs-comment">// Replace with this:</span>
MyModel.updateMany(filter, update);
</code></pre>
<h2 id="count"><a href="#count"><code>count()</code></a></h2>

<p>The MongoDB server has deprecated the <code>count()</code> function in favor of two
separate functions, <a href="#query_Query-countDocuments"><code>countDocuments()</code></a> and
<a href="#query_Query-estimatedDocumentCount"><code>estimatedDocumentCount()</code></a>.</p>
<pre><code>DeprecationWarning: collection.count is deprecated, and will be removed <span class="hljs-keyword">in</span> a future version. Use collection.countDocuments or collection.estimatedDocumentCount instead
</code></pre>
<p>The difference between the two is <code>countDocuments()</code> can accept a filter
parameter like <a href="#query_Query-find"><code>find()</code></a>. The <code>estimatedDocumentCount()</code>
function is faster, but can only tell you the total number of documents in
a collection. You cannot pass a <code>filter</code> to <code>estimatedDocumentCount()</code>.</p>
<p>To migrate, replace <code>count()</code> with <code>countDocuments()</code> <em>unless</em> you do not
pass any arguments to <code>count()</code>. If you use <code>count()</code> to count all documents
in a collection as opposed to counting documents that match a query, use
<code>estimatedDocumentCount()</code> instead of <code>countDocuments()</code>.</p>
<pre><code class="language-javascript"><span class="hljs-comment">// Replace this:</span>
MyModel.count({ <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> });
<span class="hljs-comment">// With this:</span>
MyModel.countDocuments({ <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> });

<span class="hljs-comment">// If you're counting all documents in the collection, use</span>
<span class="hljs-comment">// `estimatedDocumentCount()` instead.</span>
MyModel.count();
<span class="hljs-comment">// Replace with:</span>
MyModel.estimatedDocumentCount();

<span class="hljs-comment">// Replace this:</span>
MyModel.find({ <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> }).count().exec();
<span class="hljs-comment">// With this:</span>
MyModel.find({ <span class="hljs-attr">answer</span>: <span class="hljs-number">42</span> }).countDocuments().exec();

<span class="hljs-comment">// Replace this:</span>
MyModel.find().count().exec();
<span class="hljs-comment">// With this, since there's no filter</span>
MyModel.find().estimatedDocumentCount().exec();
</code></pre>
</div></div><script type="text/javascript">var xhr = new XMLHttpRequest();
xhr.open('POST', 'https://g0a3nbw0xa.execute-api.us-east-1.amazonaws.com/prod/track', true);
xhr.setRequestHeader('Content-Type', 'application/json');
xhr.onreadystatechange = function() {};
xhr.send(JSON.stringify({
  path: window.location.pathname,
  hostname: window.location.hostname,
  hash: window.location.hash
}));</script><script type="text/javascript" src="/docs/js/navbar-search.js"></script><script type="text/javascript">(function (window, document) {
  var layout   = document.getElementById('layout'),
      menu     = document.getElementById('menu'),
      menuLink = document.getElementById('menuLink'),
      content  = document.getElementById('content');

  function toggleClass(element, className) {
      var classes = element.className.split(/\s+/),
          length = classes.length,
          i = 0;

      for(; i < length; i++) {
        if (classes[i] === className) {
          classes.splice(i, 1);
          break;
        }
      }
      // The className is not found
      if (length === classes.length) {
          classes.push(className);
      }

      element.className = classes.join(' ');
  }

  function toggleAll(e) {
      var active = 'active';

      e.preventDefault();
      toggleClass(layout, active);
      toggleClass(menu, active);
      toggleClass(menuLink, active);
  }

  menuLink.onclick = function (e) {
      toggleAll(e);
  };

  content.onclick = function(e) {
      if (menu.className.indexOf('active') !== -1) {
          toggleAll(e);
      }
  };

}(this, this.document));</script></div></body></html>